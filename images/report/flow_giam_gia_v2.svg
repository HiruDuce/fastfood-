<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1400" height="900">
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#eef4ff"/>
      <stop offset="100%" stop-color="#f9fbff"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="#000" flood-opacity="0.15"/>
    </filter>
    <style>
      .title{font: 700 26px 'Segoe UI', Arial; fill:#173055}
      .box{fill:url(#bg); stroke:#6ea3ff; stroke-width:1.6; rx:12; filter:url(#shadow)}
      .diamond{fill:#fff7ec; stroke:#ff9f45; stroke-width:1.8; filter:url(#shadow)}
      .txt{font: 600 15px 'Segoe UI', Arial; fill:#1f355e}
      .line{stroke:#4169ff; stroke-width:1.8; marker-end:url(#arrow)}
      .label{font:600 14px 'Segoe UI', Arial; fill:#4169ff}
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#4169ff" />
    </marker>
  </defs>

  <text x="700" y="60" class="title" text-anchor="middle">Luồng áp dụng giảm giá (Admin)</text>

  <!-- Row 1 -->
  <rect x="80" y="120" width="360" height="70" class="box" />
  <text x="260" y="162" class="txt" text-anchor="middle">Admin đăng nhập</text>

  <rect x="500" y="120" width="420" height="70" class="box" />
  <text x="710" y="162" class="txt" text-anchor="middle">Mở admin.php – Tab Khuyến Mãi</text>

  <!-- Row 2 -->
  <rect x="80" y="240" width="500" height="70" class="box" />
  <text x="330" y="282" class="txt" text-anchor="middle">Chọn sản phẩm + nhập giảm % hoặc giảm tiền + từ/đến ngày</text>

  <rect x="620" y="240" width="420" height="70" class="box" />
  <text x="830" y="282" class="txt" text-anchor="middle">Gửi promo_api.php (upsert_direct_discount)</text>

  <polygon class="diamond" points="1100,275 1160,240 1220,275 1160,310"/>
  <text x="1160" y="280" class="txt" text-anchor="middle">Promotion tồn tại?</text>

  <!-- Row 3 -->
  <rect x="980" y="360" width="320" height="70" class="box" />
  <text x="1140" y="402" class="txt" text-anchor="middle">Tạo promotion mới</text>

  <rect x="980" y="470" width="320" height="70" class="box" />
  <text x="1140" y="512" class="txt" text-anchor="middle">Dùng promotion sẵn có</text>

  <!-- Row 4 -->
  <rect x="560" y="590" width="420" height="70" class="box" />
  <text x="770" y="632" class="txt" text-anchor="middle">Upsert vào promotion_items</text>

  <rect x="80" y="590" width="420" height="70" class="box" />
  <text x="290" y="632" class="txt" text-anchor="middle">Hiển thị giá sau giảm trên index/promotions</text>

  <!-- Edges -->
  <line x1="440" y1="155" x2="500" y2="155" class="line" />
  <line x1="920" y1="155" x2="1100" y2="275" class="line" />

  <line x1="580" y1="275" x2="620" y2="275" class="line" />
  <line x1="1040" y1="275" x2="1100" y2="275" class="line" />

  <line x1="1160" y1="310" x2="1140" y2="360" class="line" />
  <line x1="1160" y1="310" x2="1140" y2="470" class="line" />

  <line x1="1140" y1="430" x2="770" y2="590" class="line" />
  <line x1="1140" y1="540" x2="770" y2="590" class="line" />

  <line x1="770" y1="660" x2="290" y2="625" class="line" />
</svg>
